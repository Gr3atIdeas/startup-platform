{% extends "accounts/base.html" %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% block title %}Планетарная система стартапов{% endblock %}</title>
    {% block head_extra %}
      {{ block.super }}
      <link rel="stylesheet" href="{% static 'accounts/css/planetary_system.css' %}?v={% now 'U' %}">
      <style>
        /* ПРИНУДИТЕЛЬНЫЕ СТИЛИ ДЛЯ СОЛНЦА */
        #sun {
          position: absolute !important;
          top: 50% !important;
          left: 50% !important;
          transform: translate(-50%, -50%) !important;
          width: 120px !important;
          height: 120px !important;
          border-radius: 50% !important;
          background: radial-gradient(circle at center, #FFD700 0%, #FFA500 50%, #FF8C00 100%) !important;
          background-image: url('/static/accounts/images/planetary_system/solar.png') !important;
          background-size: cover !important;
          background-position: center !important;
          box-shadow: 0 0 50px rgba(255, 239, 43, 1), 0 0 100px rgba(255, 165, 0, 0.5) !important;
          z-index: 9999 !important;
          border: 3px solid rgba(255, 239, 43, 0.8) !important;
        }
        
        /* ПРИНУДИТЕЛЬНЫЕ СТИЛИ ДЛЯ ОРБИТ */
        .orbit {
          border: 2px solid rgba(255, 255, 255, 0.8) !important;
          position: absolute !important;
          top: 50% !important;
          left: 50% !important;
          border-radius: 50% !important;
          transform: translate(-50%, -50%) !important;
          animation: orbit-rotate linear infinite !important;
        }
        
        @keyframes orbit-rotate {
          from { transform: translate(-50%, -50%) rotate(0deg) !important; }
          to { transform: translate(-50%, -50%) rotate(360deg) !important; }
        }
      </style>
    {% endblock %}
</head>
<body>
    {% block content %}
      <div class="planetary-system-wrapper">
        <div class="planetary-system-container">
          <div class="space-background"></div>
          <div class="stars"></div>
          <div id="solar-system">
            <div id="scene">
              <div id="galaxy">
                <!-- СОЛНЦЕ В ЦЕНТРЕ -->
                <div id="sun"></div>
                
                <!-- 10 ОРБИТ С ПЛАНЕТАМИ -->
                <div class="orbit orbit-1">
                  <div class="planet-container">
                    <div class="planet planet-1" data-id="1"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-2">
                  <div class="planet-container">
                    <div class="planet planet-2" data-id="2"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-3">
                  <div class="planet-container">
                    <div class="planet planet-3" data-id="3"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-4">
                  <div class="planet-container">
                    <div class="planet planet-4" data-id="4"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-5">
                  <div class="planet-container">
                    <div class="planet planet-5" data-id="5"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-6">
                  <div class="planet-container">
                    <div class="planet planet-6" data-id="6"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-7">
                  <div class="planet-container">
                    <div class="planet planet-7" data-id="7"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-8">
                  <div class="planet-container">
                    <div class="planet planet-8" data-id="8"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-9">
                  <div class="planet-container">
                    <div class="planet planet-9" data-id="9"></div>
                  </div>
                </div>
                
                <div class="orbit orbit-10">
                  <div class="planet-container">
                    <div class="planet planet-10" data-id="10"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="info-card">
            <button id="close-card">×</button>
            <div class="planet-image" id="planet-image"></div>
            <h2 id="startup-name"></h2>
            <div class="rating" id="startup-rating"></div>
            <div class="progress-bar">
              <button>Выкуп+инвестирование</button>
              <div class="progress" id="startup-progress"></div>
            </div>
            <div class="funding" id="startup-funding"></div>
            <div class="investors" id="startup-investors"></div>
            <div class="description" id="startup-description"></div>
            <button class="more-details" id="more-details">Подробнее</button>
          </div>
          <div id="crosshair"></div>
          <div id="crosshair-coords"></div>
          <div id="mouse-coords"></div>
          <div id="axes">
            <div class="axis" id="axis-x"></div>
            <div class="axis" id="axis-y"></div>
            <div class="axis" id="axis-z"></div>
            <div class="axis-label" id="label-x">X</div>
            <div class="axis-label" id="label-y">Y</div>
            <div class="axis-label" id="label-z">Z</div>
          </div>
          <div id="fps">0 FPS</div>
          <div id="galaxy-selector">
            <button class="all-startups-button {% if selected_galaxy == 'Все' %}selected{% endif %}" data-name="Все">Все стартапы</button>
            <div id="galaxy-list">
              {% for direction in directions %}
                <div class="galaxy-item-wrapper">
                  <div class="galaxy-item {% if direction.direction_name == selected_galaxy %}selected{% endif %}" data-name="{{ direction.direction_name }}"></div>
                  <div class="category-label">{{ direction.direction_name }}</div>
                  <div class="category-description">
                    {% if direction.direction_name == "Технологии" %}
                      Инновационные IT-решения и разработки
                    {% elif direction.direction_name == "Медицина" %}
                      Здравоохранение и медицинские технологии
                    {% elif direction.direction_name == "Финтех" %}
                      Финансовые технологии и услуги
                    {% elif direction.direction_name == "Образование" %}
                      EdTech и образовательные платформы
                    {% elif direction.direction_name == "Экология" %}
                      Зеленые технологии и экология
                    {% elif direction.direction_name == "Торговля" %}
                      E-commerce и розничная торговля
                    {% elif direction.direction_name == "Транспорт" %}
                      Логистика и транспортные решения
                    {% else %}
                      Инновационные стартапы
                    {% endif %}
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    {% endblock %}

    {% block script_extra %} {# Изменено с body_scripts на script_extra для соответствия base.html #}
      {{ block.super }}
      <script id="planetary-system-data" type="application/json">
        {
          "isAuthenticated": {{ user.is_authenticated|yesno:"true,false" }},
          "isStartuper": {{ is_startuper|yesno:"true,false" }},
          "planetsData": {{ planets_data_json|safe }},
          "directionsData": {{ directions_data_json|safe }},
          "selectedGalaxy": "{{ selected_galaxy|escapejs }}",
          "logoImage": "{{ logo_data.image|default_if_none:''|escapejs }}",
          "urls": {
                "createStartup": "{% url 'create_startup' %}",
                "register": "{% url 'register' %}",
                "planetarySystemBase": "{% url 'planetary_system' %}"  {# Базовый URL для перенаправления смены галактики #}
            }
        }
      </script>
      <script src="{% static 'accounts/js/planetary_system.js' %}?v={% now 'U' %}" defer></script>
    {% endblock %}
</body>
</html>