{% extends "accounts/base.html" %}
{% load static %}

{% block title %}Мои заявки - Поддержка{% endblock %}

{% block head_extra %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'accounts/css/support_orders.css' %}?v={% now 'U' %}">
<style>
  /* Обнуляем вертикальные отступы для main.content на этой странице */
  main.content {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
</style>
{% endblock %}

{% block content %}
<div class="support-orders-page">
  <div class="support-orders-container">
    <div class="back-link-container">
      <a href="{% url 'support' %}" class="back-link">
        <img src="{% static 'accounts/images/support/arrow_left.svg' %}" alt="Назад" class="back-link-icon">
        <span>Назад</span>
      </a>
    </div>

    <section class="page-header-section">
      <h1>{% if is_moderator %}Все заявки{% else %}Мои заявки{% endif %}</h1>
      <a href="{% url 'support_contact' %}" class="btn btn-primary">Новая заявка</a>
    </section>

    <section class="search-section">
        <div class="search-bar-inline">
            <input type="text" placeholder="Поиск по теме или номеру заявки..." class="search-input-inline">
        </div>
    </section>
    
    <section class="orders-list-section">
      <div class="tickets-list">
        {% if orders %}
          {% for order in orders %}
            <a href="{% url 'support_ticket_detail' order.ticket_id %}" class="ticket-card-link">
              <div class="ticket-card">
                <div class="ticket-info"><span>Создана</span>{{ order.created_at|date:"d.m.Y" }}</div>
                <div class="ticket-info"><span>Тема</span>{{ order.subject|truncatechars:25 }}</div>
                <div class="ticket-info"><span>Статус</span>{{ order.get_status_display }}</div>
                <div class="ticket-info"><span>Номер</span>#{{ order.ticket_id }}</div>
              </div>
            </a>
          {% endfor %}
        {% else %}
          <div class="no-orders-message">
            <p>У вас пока нет созданных заявок.</p>
            <p>Если у вас есть вопрос, вы можете <a href="{% url 'support_contact' %}">создать новую заявку</a>.</p>
          </div>
        {% endif %}
      </div>
    </section>

    <section class="additional-info-section">
      <div class="info-block-left">
        <p>Ответы на большинство вопросов подробно описаны в нашем <a href="#">справочном центре</a> и <a href="#">частых вопросах</a>.</p>
        <a href="#" class="btn btn-secondary">Справочный центр</a> {# TODO: Актуальная ссылка #}
      </div>
      <div class="info-block-right">
        <p>Среднее время ответа в рабочие часы (понедельник-пятница, с 10:00 до 18:00) - 2 часа</p>
        <p>При высокой загрузке время ответа может быть увеличено</p>
        <p>В выходные дни мы отвечаем в течение суток</p>
      </div>
    </section>

  </div>
</div>
{% endblock %}
